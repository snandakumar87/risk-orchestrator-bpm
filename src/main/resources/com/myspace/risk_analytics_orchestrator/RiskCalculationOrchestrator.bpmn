<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:bpsim="http://www.bpsim.org/schemas/1.0" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:drools="http://www.jboss.org/drools" id="_-5FHETl_EDqIcsxIyUkezQ" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd http://www.jboss.org/drools drools.xsd http://www.bpsim.org/schemas/1.0 bpsim.xsd http://www.omg.org/spec/DD/20100524/DC DC.xsd http://www.omg.org/spec/DD/20100524/DI DI.xsd " exporter="jBPM Process Modeler" exporterVersion="2.0" targetNamespace="http://www.omg.org/bpmn20">
  <bpmn2:itemDefinition id="_dataItem" structureRef="com.myspace.risk_analytics_orchestrator.VarRequest"/>
  <bpmn2:itemDefinition id="_responseItem" structureRef="com.myspace.risk_analytics_orchestrator.VarResponse"/>
  <bpmn2:itemDefinition id="_resultsItem" structureRef="java.util.ArrayList"/>
  <bpmn2:itemDefinition id="_entityTypeItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_resultsObjItem" structureRef="com.myspace.risk_analytics_orchestrator.Result"/>
  <bpmn2:itemDefinition id="_responseStrItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_resultObjsItem" structureRef="java.util.ArrayList"/>
  <bpmn2:itemDefinition id="_topicDataItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_correlationIdItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_startRequestItem" structureRef="java.lang.Long"/>
  <bpmn2:itemDefinition id="_endRequestItem" structureRef="java.lang.Long"/>
  <bpmn2:itemDefinition id="_timeForRequestItem" structureRef="java.lang.Long"/>
  <bpmn2:itemDefinition id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_multiInstanceItemType_resultObj" structureRef="com.myspace.risk_analytics_orchestrator.Result"/>
  <bpmn2:itemDefinition id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_multiInstanceItemType_resultObj" structureRef="com.myspace.risk_analytics_orchestrator.Result"/>
  <bpmn2:itemDefinition id="__558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5_dataInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="var-calc-responseType" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptHeaderInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_MethodInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_UrlInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentDataInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptCharsetInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthTypeInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthUrlInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ConnectTimeoutInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeCharsetInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_HandleResponseErrorsInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_HeadersInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_PasswordInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ReadTimeoutInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultClassInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_UsernameInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultOutputXItem" structureRef="com.myspace.risk_analytics_orchestrator.VarResponse"/>
  <bpmn2:itemDefinition id="__E715BB15-4B68-4E66-A394-34B93D066943_dataOutputXItem" structureRef="com.myspace.risk_analytics_orchestrator.VarRequest"/>
  <bpmn2:itemDefinition id="var-calc-requestType" structureRef="com.myspace.risk_analytics_orchestrator.VarRequest"/>
  <bpmn2:message id="_-5KmoDl_EDqIcsxIyUkezQ" itemRef="var-calc-responseType" name="var-calc-response"/>
  <bpmn2:message id="_-5KmoTl_EDqIcsxIyUkezQ" itemRef="var-calc-requestType" name="var-calc-request"/>
  <bpmn2:process id="risk_analytics_orchestrator.RiskCalculationOrchestrator" drools:packageName="com.myspace.risk_analytics_orchestrator" drools:version="1.0" drools:adHoc="false" name="RiskCalculationOrchestrator" isExecutable="true" processType="Public">
    <bpmn2:property id="data" itemSubjectRef="_dataItem" name="data"/>
    <bpmn2:property id="response" itemSubjectRef="_responseItem" name="response"/>
    <bpmn2:property id="results" itemSubjectRef="_resultsItem" name="results"/>
    <bpmn2:property id="entityType" itemSubjectRef="_entityTypeItem" name="entityType"/>
    <bpmn2:property id="resultsObj" itemSubjectRef="_resultsObjItem" name="resultsObj"/>
    <bpmn2:property id="responseStr" itemSubjectRef="_responseStrItem" name="responseStr"/>
    <bpmn2:property id="resultObjs" itemSubjectRef="_resultObjsItem" name="resultObjs"/>
    <bpmn2:property id="topicData" itemSubjectRef="_topicDataItem" name="topicData"/>
    <bpmn2:property id="correlationId" itemSubjectRef="_correlationIdItem" name="correlationId"/>
    <bpmn2:property id="startRequest" itemSubjectRef="_startRequestItem" name="startRequest"/>
    <bpmn2:property id="endRequest" itemSubjectRef="_endRequestItem" name="endRequest"/>
    <bpmn2:property id="timeForRequest" itemSubjectRef="_timeForRequestItem" name="timeForRequest"/>
    <bpmn2:sequenceFlow id="_E7E5EC30-7A36-4599-BD84-CD122E341052" sourceRef="_76EED61D-FE37-4511-9AD4-1EF47159D26B" targetRef="_8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658">
      <bpmn2:extensionElements>
        <drools:metaData name="isAutoConnection.source">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
        <drools:metaData name="isAutoConnection.target">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
      </bpmn2:extensionElements>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="_ADC5FD0E-92CF-48EE-97A2-01E10ABA8B34" sourceRef="_E715BB15-4B68-4E66-A394-34B93D066943" targetRef="_76EED61D-FE37-4511-9AD4-1EF47159D26B">
      <bpmn2:extensionElements>
        <drools:metaData name="isAutoConnection.source">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
        <drools:metaData name="isAutoConnection.target">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
      </bpmn2:extensionElements>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="_D84EC47E-EC66-415D-A89A-108ED6EA9540" sourceRef="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC" targetRef="_81C9FEE8-BAF2-4941-9653-6B7F07FFC166">
      <bpmn2:extensionElements>
        <drools:metaData name="isAutoConnection.source">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
        <drools:metaData name="isAutoConnection.target">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
      </bpmn2:extensionElements>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="_284C19D7-9834-475E-8A4B-CE467A3BECF6" sourceRef="_8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658" targetRef="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC">
      <bpmn2:extensionElements>
        <drools:metaData name="isAutoConnection.target">
          <drools:metaValue><![CDATA[true]]></drools:metaValue>
        </drools:metaData>
      </bpmn2:extensionElements>
    </bpmn2:sequenceFlow>
    <bpmn2:scriptTask id="_8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658" name="Prepare Calculation Request" scriptFormat="http://www.java.com/java">
      <bpmn2:extensionElements>
        <drools:metaData name="elementname">
          <drools:metaValue><![CDATA[Prepare Calculation Request]]></drools:metaValue>
        </drools:metaData>
      </bpmn2:extensionElements>
      <bpmn2:incoming>_E7E5EC30-7A36-4599-BD84-CD122E341052</bpmn2:incoming>
      <bpmn2:outgoing>_284C19D7-9834-475E-8A4B-CE467A3BECF6</bpmn2:outgoing>
      <bpmn2:script>
java.util.HashMap utilMap = new com.fasterxml.jackson.databind.ObjectMapper().
readValue(String.valueOf(kcontext.getVariable("responseStr")), java.util.HashMap.class);
System.out.println(utilMap);

com.myspace.risk_analytics_orchestrator.VarResponse varResponse = new com.myspace.risk_analytics_orchestrator.VarResponse();
varResponse.setCorrelationId((String)utilMap.get("correlationId"));
varResponse.setAllAccounts((boolean)utilMap.get("allAccounts"));
varResponse.setEntityType((String)utilMap.get("entityType"));
varResponse.setConfidence((java.lang.Double)utilMap.get("confidence"));
varResponse.setEntityId((String)utilMap.get("entityId"));
 kcontext.setVariable("correlationId",(String)varResponse.getCorrelationId());

java.util.List&lt;java.util.HashMap&gt; resultMap = (java.util.List&lt;java.util.HashMap&gt;)utilMap.get("results");

java.util.List resultList = new java.util.ArrayList();
com.myspace.risk_analytics_orchestrator.Result result = null;
for(java.util.Map mapRes: resultMap) {
  result = new com.myspace.risk_analytics_orchestrator.Result();
  result.setId((String)mapRes.get("id"));
  result.setCorrelationId((String)varResponse.getCorrelationId());
  result.setValueAtRisk((java.lang.Double)mapRes.get("valueAtRisk"));
  result.setAllAccounts((boolean)utilMap.get("allAccounts"));
  if(result.getAllAccounts()) {
       result.setEntityType("account");
       result.setEntityId((String)mapRes.get("id"));
  } else {
  result.setEntityType((String)utilMap.get("entityType"));
  result.setEntityId((String)utilMap.get("entityId"));
  }
  result.setConfidence((java.lang.Double)utilMap.get("confidence"));
  
 result.setSubProcessCorrelationId(new java.util.Date().getTime());

  result.setCalcTime((Long)kcontext.getVariable("timeForRequest"));
  resultList.add(result);
}

varResponse.setResults(resultList);

kcontext.setVariable("response",varResponse);
kcontext.setVariable("results",resultList);</bpmn2:script>
    </bpmn2:scriptTask>
    <bpmn2:endEvent id="_81C9FEE8-BAF2-4941-9653-6B7F07FFC166">
      <bpmn2:incoming>_D84EC47E-EC66-415D-A89A-108ED6EA9540</bpmn2:incoming>
    </bpmn2:endEvent>
    <bpmn2:startEvent id="_E715BB15-4B68-4E66-A394-34B93D066943">
      <bpmn2:outgoing>_ADC5FD0E-92CF-48EE-97A2-01E10ABA8B34</bpmn2:outgoing>
      <bpmn2:dataOutput id="_E715BB15-4B68-4E66-A394-34B93D066943_dataOutputX" drools:dtype="com.myspace.risk_analytics_orchestrator.VarRequest" itemSubjectRef="__E715BB15-4B68-4E66-A394-34B93D066943_dataOutputXItem" name="data"/>
      <bpmn2:dataOutputAssociation>
        <bpmn2:sourceRef>_E715BB15-4B68-4E66-A394-34B93D066943_dataOutputX</bpmn2:sourceRef>
        <bpmn2:targetRef>data</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
      <bpmn2:outputSet>
        <bpmn2:dataOutputRefs>_E715BB15-4B68-4E66-A394-34B93D066943_dataOutputX</bpmn2:dataOutputRefs>
      </bpmn2:outputSet>
      <bpmn2:messageEventDefinition drools:msgref="var-calc-request" messageRef="_-5KmoTl_EDqIcsxIyUkezQ"/>
    </bpmn2:startEvent>
    <bpmn2:task id="_76EED61D-FE37-4511-9AD4-1EF47159D26B" drools:taskName="Rest" name="Invoke Calc Service">
      <bpmn2:documentation><![CDATA[jbpm-workitems-rest/index.html]]></bpmn2:documentation>
      <bpmn2:extensionElements>
        <drools:metaData name="elementname">
          <drools:metaValue><![CDATA[Invoke Calc Service]]></drools:metaValue>
        </drools:metaData>
        <drools:onEntry-script scriptFormat="http://www.java.com/java">
          <drools:script><![CDATA[kcontext.setVariable("startRequest",new java.util.Date().getTime());]]></drools:script>
        </drools:onEntry-script>
        <drools:onExit-script scriptFormat="http://www.java.com/java">
          <drools:script><![CDATA[kcontext.setVariable("endRequest",new java.util.Date().getTime());

Long timeInt = (Long)kcontext.getVariable("endRequest") - (Long)kcontext.getVariable("startRequest");

kcontext.setVariable("timeForRequest",timeInt/1000);]]></drools:script>
        </drools:onExit-script>
      </bpmn2:extensionElements>
      <bpmn2:incoming>_ADC5FD0E-92CF-48EE-97A2-01E10ABA8B34</bpmn2:incoming>
      <bpmn2:outgoing>_E7E5EC30-7A36-4599-BD84-CD122E341052</bpmn2:outgoing>
      <bpmn2:ioSpecification>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptHeaderInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptHeaderInputXItem" name="AcceptHeader"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeInputXItem" name="ContentType"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_MethodInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_MethodInputXItem" name="Method"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_UrlInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_UrlInputXItem" name="Url"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentDataInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentDataInputXItem" name="ContentData"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptCharsetInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptCharsetInputXItem" name="AcceptCharset"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthTypeInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthTypeInputXItem" name="AuthType"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthUrlInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthUrlInputXItem" name="AuthUrl"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ConnectTimeoutInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ConnectTimeoutInputXItem" name="ConnectTimeout"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeCharsetInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeCharsetInputXItem" name="ContentTypeCharset"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_HandleResponseErrorsInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_HandleResponseErrorsInputXItem" name="HandleResponseErrors"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_HeadersInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_HeadersInputXItem" name="Headers"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_PasswordInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_PasswordInputXItem" name="Password"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ReadTimeoutInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ReadTimeoutInputXItem" name="ReadTimeout"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultClassInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultClassInputXItem" name="ResultClass"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_UsernameInputX" drools:dtype="String" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_UsernameInputXItem" name="Username"/>
        <bpmn2:dataInput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_TaskNameInputX" drools:dtype="Object" name="TaskName"/>
        <bpmn2:dataOutput id="_76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultOutputX" drools:dtype="com.myspace.risk_analytics_orchestrator.VarResponse" itemSubjectRef="__76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultOutputXItem" name="Result"/>
        <bpmn2:inputSet>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptHeaderInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_MethodInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_UrlInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentDataInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptCharsetInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthTypeInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_AuthUrlInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ConnectTimeoutInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeCharsetInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_HandleResponseErrorsInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_HeadersInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_PasswordInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ReadTimeoutInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultClassInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_UsernameInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_TaskNameInputX</bpmn2:dataInputRefs>
        </bpmn2:inputSet>
        <bpmn2:outputSet>
          <bpmn2:dataOutputRefs>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultOutputX</bpmn2:dataOutputRefs>
        </bpmn2:outputSet>
      </bpmn2:ioSpecification>
      <bpmn2:dataInputAssociation>
        <bpmn2:targetRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptHeaderInputX</bpmn2:targetRef>
        <bpmn2:assignment>
          <bpmn2:from xsi:type="bpmn2:tFormalExpression"><![CDATA[application/json]]></bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression"><![CDATA[_76EED61D-FE37-4511-9AD4-1EF47159D26B_AcceptHeaderInputX]]></bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation>
        <bpmn2:targetRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeInputX</bpmn2:targetRef>
        <bpmn2:assignment>
          <bpmn2:from xsi:type="bpmn2:tFormalExpression"><![CDATA[application/json]]></bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression"><![CDATA[_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentTypeInputX]]></bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation>
        <bpmn2:targetRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_MethodInputX</bpmn2:targetRef>
        <bpmn2:assignment>
          <bpmn2:from xsi:type="bpmn2:tFormalExpression"><![CDATA[POST]]></bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression"><![CDATA[_76EED61D-FE37-4511-9AD4-1EF47159D26B_MethodInputX]]></bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation>
        <bpmn2:targetRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_UrlInputX</bpmn2:targetRef>
        <bpmn2:assignment>
          <bpmn2:from xsi:type="bpmn2:tFormalExpression"><![CDATA[http://var-wrapper.var-wrapper.svc.cluster.local:8080/var]]></bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression"><![CDATA[_76EED61D-FE37-4511-9AD4-1EF47159D26B_UrlInputX]]></bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation>
        <bpmn2:sourceRef>data</bpmn2:sourceRef>
        <bpmn2:targetRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ContentDataInputX</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation>
        <bpmn2:targetRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_TaskNameInputX</bpmn2:targetRef>
        <bpmn2:assignment>
          <bpmn2:from xsi:type="bpmn2:tFormalExpression"><![CDATA[Rest]]></bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression"><![CDATA[_76EED61D-FE37-4511-9AD4-1EF47159D26B_TaskNameInputX]]></bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataOutputAssociation>
        <bpmn2:sourceRef>_76EED61D-FE37-4511-9AD4-1EF47159D26B_ResultOutputX</bpmn2:sourceRef>
        <bpmn2:targetRef>responseStr</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
    </bpmn2:task>
    <bpmn2:subProcess id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC" name="For every account calculation">
      <bpmn2:extensionElements>
        <drools:metaData name="elementname">
          <drools:metaValue><![CDATA[For every account calculation]]></drools:metaValue>
        </drools:metaData>
      </bpmn2:extensionElements>
      <bpmn2:incoming>_284C19D7-9834-475E-8A4B-CE467A3BECF6</bpmn2:incoming>
      <bpmn2:outgoing>_D84EC47E-EC66-415D-A89A-108ED6EA9540</bpmn2:outgoing>
      <bpmn2:ioSpecification>
        <bpmn2:dataInput id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_IN_COLLECTIONInputX" itemSubjectRef="_resultsItem" name="IN_COLLECTION"/>
        <bpmn2:dataInput id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_resultObjInputX" itemSubjectRef="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_multiInstanceItemType_resultObj" name="resultObj"/>
        <bpmn2:dataOutput id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_OUT_COLLECTIONOutputX" itemSubjectRef="_resultObjsItem" name="OUT_COLLECTION"/>
        <bpmn2:dataOutput id="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_resultObjOutputX" itemSubjectRef="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_multiInstanceItemType_resultObj" name="resultObj"/>
        <bpmn2:inputSet>
          <bpmn2:dataInputRefs>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_IN_COLLECTIONInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_resultObjInputX</bpmn2:dataInputRefs>
        </bpmn2:inputSet>
        <bpmn2:outputSet>
          <bpmn2:dataOutputRefs>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_OUT_COLLECTIONOutputX</bpmn2:dataOutputRefs>
          <bpmn2:dataOutputRefs>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_resultObjOutputX</bpmn2:dataOutputRefs>
        </bpmn2:outputSet>
      </bpmn2:ioSpecification>
      <bpmn2:dataInputAssociation>
        <bpmn2:sourceRef>results</bpmn2:sourceRef>
        <bpmn2:targetRef>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_IN_COLLECTIONInputX</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataOutputAssociation>
        <bpmn2:sourceRef>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_OUT_COLLECTIONOutputX</bpmn2:sourceRef>
        <bpmn2:targetRef>resultObjs</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
      <bpmn2:multiInstanceLoopCharacteristics>
        <bpmn2:loopDataInputRef>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_IN_COLLECTIONInputX</bpmn2:loopDataInputRef>
        <bpmn2:loopDataOutputRef>_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_OUT_COLLECTIONOutputX</bpmn2:loopDataOutputRef>
        <bpmn2:inputDataItem id="resultObj" itemSubjectRef="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_multiInstanceItemType_resultObj" name="resultObj"/>
        <bpmn2:outputDataItem id="resultObj" itemSubjectRef="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_multiInstanceItemType_resultObj" name="resultObj"/>
      </bpmn2:multiInstanceLoopCharacteristics>
      <bpmn2:sequenceFlow id="_F30ACF0E-BAB2-48AB-B8BB-33C189D0FF8D" sourceRef="_28FDB3CC-4B7C-4D84-B50A-D3553F460471" targetRef="_466F7B77-1F9A-4CFD-8264-83EF29286CCA">
        <bpmn2:extensionElements>
          <drools:metaData name="isAutoConnection.source">
            <drools:metaValue><![CDATA[true]]></drools:metaValue>
          </drools:metaData>
          <drools:metaData name="isAutoConnection.target">
            <drools:metaValue><![CDATA[true]]></drools:metaValue>
          </drools:metaData>
        </bpmn2:extensionElements>
      </bpmn2:sequenceFlow>
      <bpmn2:sequenceFlow id="_F68C8533-667D-4BFD-8E9F-3D347F76995D" sourceRef="_466F7B77-1F9A-4CFD-8264-83EF29286CCA" targetRef="_558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5"/>
      <bpmn2:scriptTask id="_466F7B77-1F9A-4CFD-8264-83EF29286CCA" name="Process Calculation Results" scriptFormat="http://www.java.com/java">
        <bpmn2:extensionElements>
          <drools:metaData name="elementname">
            <drools:metaValue><![CDATA[Process Calculation Results]]></drools:metaValue>
          </drools:metaData>
        </bpmn2:extensionElements>
        <bpmn2:incoming>_F30ACF0E-BAB2-48AB-B8BB-33C189D0FF8D</bpmn2:incoming>
        <bpmn2:outgoing>_F68C8533-667D-4BFD-8E9F-3D347F76995D</bpmn2:outgoing>
        <bpmn2:script>System.out.println(new com.fasterxml.jackson.databind.ObjectMapper().writeValueAsString(kcontext.getVariable("resultObj")));



kcontext.setVariable("topicData",String.valueOf(kcontext.getVariable("resultObj"))) ;

System.out.println(kcontext.getVariable("topicData"));</bpmn2:script>
      </bpmn2:scriptTask>
      <bpmn2:startEvent id="_28FDB3CC-4B7C-4D84-B50A-D3553F460471">
        <bpmn2:outgoing>_F30ACF0E-BAB2-48AB-B8BB-33C189D0FF8D</bpmn2:outgoing>
      </bpmn2:startEvent>
      <bpmn2:endEvent id="_558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5">
        <bpmn2:incoming>_F68C8533-667D-4BFD-8E9F-3D347F76995D</bpmn2:incoming>
        <bpmn2:dataInput id="_558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5_dataInputX" drools:dtype="String" itemSubjectRef="__558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5_dataInputXItem" name="data"/>
        <bpmn2:dataInputAssociation>
          <bpmn2:sourceRef>topicData</bpmn2:sourceRef>
          <bpmn2:targetRef>_558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5_dataInputX</bpmn2:targetRef>
        </bpmn2:dataInputAssociation>
        <bpmn2:inputSet>
          <bpmn2:dataInputRefs>_558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5_dataInputX</bpmn2:dataInputRefs>
        </bpmn2:inputSet>
        <bpmn2:messageEventDefinition drools:msgref="var-calc-response" messageRef="_-5KmoDl_EDqIcsxIyUkezQ"/>
      </bpmn2:endEvent>
    </bpmn2:subProcess>
  </bpmn2:process>
  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane bpmnElement="risk_analytics_orchestrator.RiskCalculationOrchestrator">
      <bpmndi:BPMNShape id="shape__B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC" bpmnElement="_B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC">
        <dc:Bounds height="201" width="369" x="838" y="33"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="shape__558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5" bpmnElement="_558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5">
        <dc:Bounds height="56" width="56" x="1121" y="106"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="shape__28FDB3CC-4B7C-4D84-B50A-D3553F460471" bpmnElement="_28FDB3CC-4B7C-4D84-B50A-D3553F460471">
        <dc:Bounds height="56" width="56" x="865" y="106"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="shape__466F7B77-1F9A-4CFD-8264-83EF29286CCA" bpmnElement="_466F7B77-1F9A-4CFD-8264-83EF29286CCA">
        <dc:Bounds height="102" width="154" x="944" y="83"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="edge_shape__466F7B77-1F9A-4CFD-8264-83EF29286CCA_to_shape__558DD5CF-C9A8-45E0-A7E8-27F5AD05ACE5" bpmnElement="_F68C8533-667D-4BFD-8E9F-3D347F76995D">
        <di:waypoint x="1021" y="134"/>
        <di:waypoint x="1149" y="134"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="edge_shape__28FDB3CC-4B7C-4D84-B50A-D3553F460471_to_shape__466F7B77-1F9A-4CFD-8264-83EF29286CCA" bpmnElement="_F30ACF0E-BAB2-48AB-B8BB-33C189D0FF8D">
        <di:waypoint x="921" y="134"/>
        <di:waypoint x="944" y="134"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="shape__76EED61D-FE37-4511-9AD4-1EF47159D26B" bpmnElement="_76EED61D-FE37-4511-9AD4-1EF47159D26B">
        <dc:Bounds height="102" width="154" x="229" y="83"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="shape__E715BB15-4B68-4E66-A394-34B93D066943" bpmnElement="_E715BB15-4B68-4E66-A394-34B93D066943">
        <dc:Bounds height="56" width="56" x="101" y="106"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="shape__81C9FEE8-BAF2-4941-9653-6B7F07FFC166" bpmnElement="_81C9FEE8-BAF2-4941-9653-6B7F07FFC166">
        <dc:Bounds height="56" width="56" x="1289" y="106"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="shape__8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658" bpmnElement="_8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658">
        <dc:Bounds height="102" width="154" x="527" y="83"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="edge_shape__8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658_to_shape__B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC" bpmnElement="_284C19D7-9834-475E-8A4B-CE467A3BECF6">
        <di:waypoint x="604" y="134"/>
        <di:waypoint x="838" y="133.5"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="edge_shape__B1C43D6E-BF5D-4FC9-8DCA-51A96E4269CC_to_shape__81C9FEE8-BAF2-4941-9653-6B7F07FFC166" bpmnElement="_D84EC47E-EC66-415D-A89A-108ED6EA9540">
        <di:waypoint x="1207" y="133.5"/>
        <di:waypoint x="1289" y="134"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="edge_shape__E715BB15-4B68-4E66-A394-34B93D066943_to_shape__76EED61D-FE37-4511-9AD4-1EF47159D26B" bpmnElement="_ADC5FD0E-92CF-48EE-97A2-01E10ABA8B34">
        <di:waypoint x="129" y="162"/>
        <di:waypoint x="306" y="83"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="edge_shape__76EED61D-FE37-4511-9AD4-1EF47159D26B_to_shape__8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658" bpmnElement="_E7E5EC30-7A36-4599-BD84-CD122E341052">
        <di:waypoint x="383" y="134"/>
        <di:waypoint x="527" y="134"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
  <bpmn2:relationship type="BPSimData">
    <bpmn2:extensionElements>
      <bpsim:BPSimData>
        <bpsim:Scenario id="default" name="Simulationscenario">
          <bpsim:ScenarioParameters/>
          <bpsim:ElementParameters elementRef="_76EED61D-FE37-4511-9AD4-1EF47159D26B">
            <bpsim:TimeParameters>
              <bpsim:ProcessingTime>
                <bpsim:NormalDistribution mean="0" standardDeviation="0"/>
              </bpsim:ProcessingTime>
            </bpsim:TimeParameters>
            <bpsim:ResourceParameters>
              <bpsim:Availability>
                <bpsim:FloatingParameter value="0"/>
              </bpsim:Availability>
              <bpsim:Quantity>
                <bpsim:FloatingParameter value="0"/>
              </bpsim:Quantity>
            </bpsim:ResourceParameters>
            <bpsim:CostParameters>
              <bpsim:UnitCost>
                <bpsim:FloatingParameter value="0"/>
              </bpsim:UnitCost>
            </bpsim:CostParameters>
          </bpsim:ElementParameters>
          <bpsim:ElementParameters elementRef="_8F0BC7E5-46BE-4D1B-A1B7-83D1E53C3658">
            <bpsim:TimeParameters>
              <bpsim:ProcessingTime>
                <bpsim:NormalDistribution mean="0" standardDeviation="0"/>
              </bpsim:ProcessingTime>
            </bpsim:TimeParameters>
            <bpsim:ResourceParameters>
              <bpsim:Availability>
                <bpsim:FloatingParameter value="0"/>
              </bpsim:Availability>
              <bpsim:Quantity>
                <bpsim:FloatingParameter value="0"/>
              </bpsim:Quantity>
            </bpsim:ResourceParameters>
            <bpsim:CostParameters>
              <bpsim:UnitCost>
                <bpsim:FloatingParameter value="0"/>
              </bpsim:UnitCost>
            </bpsim:CostParameters>
          </bpsim:ElementParameters>
        </bpsim:Scenario>
      </bpsim:BPSimData>
    </bpmn2:extensionElements>
    <bpmn2:source>_-5FHETl_EDqIcsxIyUkezQ</bpmn2:source>
    <bpmn2:target>_-5FHETl_EDqIcsxIyUkezQ</bpmn2:target>
  </bpmn2:relationship>
</bpmn2:definitions>
